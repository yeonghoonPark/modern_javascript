/**
 * 22-1. this í‚¤ì›Œë“œ
 *
 * `this`ëŠ” í˜¸ì¶œë˜ëŠ” ê³³ì— ë”°ë¼ ì •ì  ë˜ëŠ” ë™ì ìœ¼ë¡œ ë°”ì¸ë”©ëœë‹¤.
 * `this`ëŠ” í¬ê²Œ 5ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìžˆë‹¤.
 *
 * 1. ì „ì—­ ì»¨í…ìŠ¤íŠ¸ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ìµœìƒìœ„ ê°ì²´ì¸ `window` ë˜ëŠ” `global`ì„ ê°€ë¦¬í‚¨ë‹¤.
 * 2. ê°ì²´ ì•ˆì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ê°ì²´ ìžì‹ ì„ ê°€ë¦¬í‚¨ë‹¤.
 * 3. constructor ìƒì„±ìž í•¨ìˆ˜ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ë¯¸ëž˜ì— ìƒì„±ë  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
 * 4. ì¼ë°˜ í•¨ìˆ˜ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ë™ì ìœ¼ë¡œ `this`ê°€ í˜¸ì¶œë˜ëŠ” ìœ„ì¹˜ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. (`use strict` ì‚¬ìš© ì‹œ `undefined`, ì•„ë‹ ê²½ìš° `window` ë˜ëŠ” `global`)
 * 5. non-constructor í•¨ìˆ˜ì—ì„œ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ì •ì ìœ¼ë¡œ ìƒìœ„ ìŠ¤ì½”í”„ì˜ `this`ë¥¼ ê°€ë¦¬í‚¨ë‹¤. (non-constructorì¸ ES6 ë©”ì„œë“œ ì¶•ì•½ì€ ê°ì²´ ë‚´ë¶€ì—ì„œ í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì— ê°ì²´ ìžì‹ ì„ ê°€ë¦¬í‚¨ë‹¤.)
 *
 * `this`ëŠ” ê°ì²´ì˜ í”„ë¡œí¼í‹°ë‚˜ ë©”ì„œë“œë¥¼ ì°¸ì¡°í•˜ê¸° ìœ„í•œ ìžê¸° ì°¸ì¡° ë³€ìˆ˜ì´ë‹¤.
 * ì¦‰, ê°ì²´ì˜ ë©”ì„œë“œë‚˜ ìƒì„±ìž í•¨ìˆ˜ì—ì„œë§Œ ì˜ë¯¸ê°€ ìžˆê¸° ë•Œë¬¸ì— `use strict`ì—ì„œëŠ” ì¼ë°˜ í•¨ìˆ˜ì˜ ê²½ìš° `undefined`ê°€ ë°”ì¸ë”©ëœë‹¤.
 * `new` í‚¤ì›Œë“œê°€ ì—†ëŠ” ì¼ë°˜ í•¨ìˆ˜ì—ì„œëŠ” `this`ë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.
 *
 */

// ðŸ‘‰ 1. ì „ì—­ ì»¨í…ìŠ¤íŠ¸ì—ì„œ í˜¸ì¶œí•˜ë©´ ìµœìƒìœ„ ê°ì²´ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
this === window; // true

// ðŸ‘‰ 2. ê°ì²´ ì•ˆì—ì„œ í˜¸ì¶œí•˜ë©´ ê°ì²´ ìžì‹ ì„ ê°€ë¦¬í‚¨ë‹¤.
{
  const fruit = {
    name: "apple",
    getName() {
      return this.name;
    },
  };

  fruit.getName(); // apple
}

// ðŸ‘‰ 3. ìƒì„±ìž í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œí•˜ë©´ ë¯¸ëž˜ì— ìƒì„±ë  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
function Circle() {
  this.radius = 5; // ë¯¸ëž˜ì— ìƒì„±ë  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
}

// ðŸ‘‰ 4. constructor ì¼ë°˜ í•¨ìˆ˜(function declaration, function expression)ì—ì„œ í˜¸ì¶œí•˜ë©´ ì „ì—­ ê°ì²´ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
// â—ï¸ ë‹¨, `use strict` ì‚¬ìš© ì‹œ `undefined`ë¥¼ ë°˜í™˜í•œë‹¤.
function foo() {
  console.log(this); // window
}

// ðŸ‘‰ 5. non-constructor í™”ì‚´í‘œ í•¨ìˆ˜ì—ì„œ í˜¸ì¶œí•˜ë©´ ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
// â—ï¸ ë‹¨, non-constructor ì¸ ES6 ë©”ì„œë“œ ì¶•ì•½ì€ ê°ì²´ ë‚´ë¶€ì—ì„œ í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì— ê°ì²´ ìžì‹ ì„ ê°€ë¦¬í‚¨ë‹¤.
const bar = () => {
  console.log(this); // window (ìƒìœ„ ìŠ¤ì½”í”„ì˜ `this`, ì¦‰ `window`ë¥¼ ê°€ë¦¬í‚´)
};

// ê°ì²´ ë‚´ë¶€ì˜ í™”ì‚´í‘œ í•¨ìˆ˜ì—ì„œ `this`ë¥¼ í˜¸ì¶œí•˜ë©´ ê°ì²´ ìžì‹ ì´ ì•„ë‹Œ ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
const animal = {
  name: "Tiger",
  getName: () => this.name, // undefined, (ìƒìœ„ ìŠ¤ì½”í”„ì˜ `this`, ì¦‰ `window`ì˜ í”„ë¡œí¼í‹°ì—ì„œ nameì„ ì°¾ê¸° ë•Œë¬¸ì´ë‹¤.)
};

// ê°ì²´ ë‚´ë¶€ì—ì„œ ES6 ì¶•ì•½ ë©”ì„œë“œì—ì„œ `this`ë¥¼ í˜¸ì¶œí•˜ë©´ ê°ì²´ ìžì‹ ì„ ê°€ë¦¬í‚¨ë‹¤.
const insect = {
  name: "Fly",
  getName() {
    return this.name; // Fly, (ES6 ì¶•ì•½ ë©”ì„œë“œëŠ” ê°ì²´ ìžì‹ ì„ ê°€ë¦¬í‚´)
  },
};

/**
 * 22-2. í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹ê³¼ this ë°”ì¸ë”©
 *
 * `this` ë°”ì¸ë”©ì€ í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹, ì¦‰ í•¨ìˆ˜ê°€ ì–´ë–»ê²Œ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ì— ë”°ë¼ ë™ì ìœ¼ë¡œ ê²°ì •ëœë‹¤.
 *
 * â—ï¸ ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ì™€ this ë°”ì¸ë”©ì€ ê²°ì • ì‹œê¸°ê°€ ë‹¤ë¥´ë‹¤.
 * í•¨ìˆ˜ì˜ ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ê²°ì •í•˜ëŠ” ë°©ì‹ì¸ ë ‰ì‹œì»¬ ìŠ¤ì½”í”„ëŠ” í•¨ìˆ˜ê°€ ì–´ë””ì„œ í˜¸ì¶œë˜ì—ˆëƒê°€ ì•„ë‹Œ í•¨ìˆ˜ê°€ ì–´ë””ì„œ ì •ì˜ë˜ì—ˆëƒì— ë”°ë¼ ìŠ¤ì½”í”„ì˜ ìœ íš¨ ë²”ìœ„ë¥¼ ê²°ì •í•˜ëŠ” ë°©ì‹ì´ë‹¤.
 * ì¦‰ í•¨ìˆ˜ ì •ì˜ê°€ í‰ê°€ë˜ì–´ ê°ì²´ê°€ ìƒì„±ë˜ëŠ” ì‹œì ì— ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ê²°ì •í•˜ëŠ” ë°˜ë©´ `this`ì˜ ì°¸ì¡° ê°’ì€ í•¨ìˆ˜ í˜¸ì¶œ ì‹œì ì— ê²°ì •ëœë‹¤.
 *
 * í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹ì€ í¬ê²Œ 4ê°€ì§€ë¡œ ë¶„ë¥˜í•œë‹¤.
 *
 * 1. ì¼ë°˜ í•¨ìˆ˜ í˜¸ì¶œ (function declaration, function expression)
 * 2. ë©”ì„œë“œ í˜¸ì¶œ
 * 3. ìƒì„±ìž í•¨ìˆ˜ í˜¸ì¶œ
 * 4. Function.prototype.apply/call/bind ë©”ì„œë“œì— ì˜í•œ ê°„ì ‘ í˜¸ì¶œ
 *
 */

{
  // `this`ëŠ” í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹ì— ë”°ë¼ ë™ì ìœ¼ë¡œ ê²°ì •ëœë‹¤.
  const foo = function () {
    // "use strict";
    console.log(this);
  };

  // 1. ì¼ë°˜ í•¨ìˆ˜ í˜¸ì¶œ, í•­ìƒ ìµœìƒìœ„ ê°ì²´ì¸ `window`ë¥¼ ì°¸ì¡°í•œë‹¤. (ë‹¨ strict ëª¨ë“œì—ì„œëŠ” `undefined`ë¥¼ ì°¸ì¡°í•œë‹¤.)
  foo(); // window

  // 2. ë©”ì„œë“œ í˜¸ì¶œ, ê°ì²´ ìžì‹ ì„ ì°¸ì¡°í•œë‹¤.
  const bar = { foo };
  bar.foo(); // obj, { foo: f }

  // 3. ìƒì„±ìž í•¨ìˆ˜ í˜¸ì¶œ, ë¯¸ëž˜ì— ìƒì„±ë  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì°¸ì¡°í•œë‹¤.
  new foo(); // {}

  // 4. Function.prototype.apply/call/bind ë©”ì„œë“œì— ì˜í•œ ê°„ì ‘ í˜¸ì¶œ, `foo` í•¨ìˆ˜ì˜ `this`ëŠ” ì¸ìžì— ì˜í•´ ê²°ì •ëœë‹¤.
  const student = { name: "Alice" };
  foo.apply(student); // student
  foo.call(student); // student
  foo.bind(student)(); // student

  // â—ï¸ ë‹¨, í™”ì‚´í‘œ í•¨ìˆ˜ì˜ ê²½ìš° ì¸ìžì™€ ê´€ê³„ì—†ì´ `this`ëŠ” í•­ìƒ ìƒìœ„ ìŠ¤ì½”í”„ë¥¼ ì°¸ì¡°í•œë‹¤.
  const arrowFunc = () => console.log(this);
  arrowFunc.apply(student); // window
  arrowFunc.call(student); // window
  arrowFunc.bind(student)(); // window
}
